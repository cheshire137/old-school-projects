<% unless session[:result].nil? %>
  <%= render :partial => 'results', :object => session[:result],
    :locals => {:columns => session[:columns]} %>
<% end %>

<% form_tag :action => session[:tables_created] ? :run_query : :create_tables do %>
  <% if session[:tables_created] %>
    <%= render :partial => 'query', :object => session[:query],
      :locals => {:user_name => session[:user_name]} %>
    <%= render :partial => 'schema_summary',
      :locals => {:clients => @clients_schema,
      :user_levels => @user_levels_schema} %>
  <% else %>
    <%= render :partial => 'clients_schema', :object => session[:schema] %>
    <%= render :partial => 'user_levels_schema', :object => session[:user_levels] %>
  <% end %>
  
  <article id="submit">
    <% if session[:tables_created] %>
      <%= submit_tag 'Run query', :name => 'run_query' %> /
      <%= submit_tag 'Drop tables, reset form', :name => 'logout', :id => 'logout',
        :confirm => "Are you sure you want to reset the form and drop all tables?" %>
    <% else %>
      <%= submit_tag 'Create tables', :name => 'create_tables' %>
    <% end %>
  </article>
<% end %>